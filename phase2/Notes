Not too much to add. All code works but is to be tweaked to your situation 
Threestages is more theortical while test1.py is actually used for me. 
